<div class="auth-form">
  <header><h1>Mot de passe oublié</h1></header>
  <form (ngSubmit)="onSubmit()" autocomplete="off">
    <!-- Email field -->
    <mat-form-field appearance="outline">
      <mat-label>Entrez votre email</mat-label>
      <input
        matInput
        placeholder="email@example.com"
        [formControl]="email"
        type="email"
        required
        autocomplete="username"
        (blur)="updateErrorMessages()"
        (focus)="clearApiError()"
        (input)="clearApiError()"
      />
      @if (email.invalid && (email.dirty || email.touched)) {
        <mat-error>
          @for (msg of errorMessages(); track msg) {
            <div>{{ msg }}</div>
          }
        </mat-error>
      }
    </mat-form-field>

    <!-- API error message -->
    <div class="api-error-message" *ngIf="apiErrorMessage()">
      {{ apiErrorMessage() }}
    </div>

    <!-- Success message -->
    <div class="success-message" *ngIf="successMessage()">
      {{ successMessage() }}
    </div>

    <button
      mat-raised-button
      type="submit"
      [disabled]="email.invalid"
    >
      Envoyer le code
    </button>

    <p>
      <a [routerLink]="['../login']">Retour à la connexion</a>
    </p>
  </form>
</div>
